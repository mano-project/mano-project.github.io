<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" translate="no" class="notranslate" lang="en">
    <head>
        <title>MANO - Maps | Visualizing Libraries and Origin Places</title>
        <meta name="keywords" content="manuscript maps, provenance, origin, digital humanities, data visualization, GIS, MANO">
        <meta name="description" content="Explore interactive maps visualizing the geographic origins and current locations of manuscripts in the MANO Metadata Collection.">
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0 shrink-to-fit=no"/>
        <meta name="google" content="notranslate"/>
        <link rel="canonical" href="https://mano-project.github.io/maps.html">
        <link rel="icon" type="image/png" href="images/MANO.png"> 
        <link rel="alternate" hreflang="en" href="URL">
        <meta property="og:type" content="website">
        <meta property="og:title" content="MANO – Maps">
        <meta property="og:description" content="Interactive visualization of manuscript origins and repositories from the MANO Metadata Collection.">
        <meta property="og:image" content="https://mano-project.github.io/images/MANO.png">
        <meta property="og:url" content="https://mano-project.github.io/maps.html">

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebPage",
            "name": "MANO – Maps",
            "url": "https://mano-project.github.io/maps.html",
            "description": "Interactive maps visualizing the current storage and origin place of manuscripts described in the MANO Metadata Collection.",
            "isPartOf": {
                "@type": "Dataset",
                "name": "MANO Metadata Collection"
            },
            "creator": {
                "@type": "Person",
                "name": "Michela Parma",
                "affiliation": "University of Mainz"
            }
            "inLanguage": "en"
        }
        </script>

        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
               
        <link rel="stylesheet" type="text/css" href="css/style.css" media="screen"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

        <!-- Leaflet -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

        <style>
            #mapCurrent, #mapOrigin {
                height: 500px;
                margin-top: 1rem;
                width: 100%;
                border: 1px solid #dee2e6;
                border-radius: 0.5rem;  
            }
        </style>
        
    </head>
    <body>
        <nav class="navbar bg-body-tertiary ">
            <div class="container-fluid d-flex justify-content-between align-items-center position-relative py-2">

                <!-- Invisible spacer to balance layout -->
                <div style="width: 80px;"></div>

                <!-- Centered logo -->
                <div class="position-absolute start-50 translate-middle-x text-center">
                <a class="navbar-brand" href="index.html">
                    <img src="images/MANO.png" alt="MANO project logo" width="65" class="d-inline-block align-text-top">
                </a>
                </div>

                <!-- Offcanvas toggle aligned right -->
                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
                aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>

                <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">&lt;MANO&gt;</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="resources.html">Resources</a></li>
                    <li class="nav-item"><a class="nav-link" href="editor.html">Metadata Editor</a></li>
                    <li class="nav-item"><a class="nav-link" href="collection.html">Metadata Collection</a></li>
                    <li class="nav-item"><a class="nav-link" href="viewer.html">Transcription Viewer</a></li>
                    <li class="nav-item"><a class="nav-link active" href="about.html">About</a></li>
                    </ul>
                </div>
                </div>
            </div>
        </nav>

    <div class="container mt-4">
            
        <button onclick="history.back()" class="btn back-btn btn-sm btn-outline-secondary" aria-label="Go back">Back</button>
            
        <h1 class="page-title">Manuscript Maps</h1>

        <div class="row my-4 align-items-end">
          <!-- Left column -->
          <div class="col-12 col-md-6 d-flex justify-content-start mb-2 mb-md-0">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#infoMaps" aria-label="Open About Manuscript Maps">
              <i class="bi bi-info-circle"></i> About Manuscript Maps
            </button>
          </div>
        </div>

        <!-- About Maps Modal -->
        <div class="modal fade" id="infoMaps" tabindex="-1" aria-labelledby="infoMapsLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="infoMapsLabel">About Manuscript Maps</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <p>
                    The Manuscript Maps visualize the geographical distribution of manuscripts recorded in the MANO database. 
                    Two maps are displayed side by side: the first shows the current place of storage (the library or institution where the manuscript is preserved today), 
                    while the second shows the place of origin (the location where the manuscript was produced).
                    </p>
                    <p>
                    Each marker represents one or more manuscripts. By clicking on a marker, you can view the list of manuscripts connected to that location and access their metadata in the <a href="collection.html" target="_blank">Metadata Collection</a>.
                    </p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close">Close</button>
              </div>
            </div>
          </div>
        </div>

        <div class="container mb-5">
            <div class="row">
                <div class="col-12 col-md-6">
                    <h4 style="color:#eeba2b;" class="text-center">Place of Storage (Current Library)</h4>
                    <div id="mapCurrent"></div>
                </div>
                <div class="col-12 col-md-6">
                    <h4 style="color:#eeba2b;" class="text-center">Places of Origin</h4>
                    <div id="mapOrigin"></div>
                </div>
            </div>
        </div>
    </div>


        <footer class="footer bg-body-tertiary text-center py-4">
            <div class="container">

            <!-- Logo centered -->
            <div class="mb-3">
                <a class="navbar-brand" href="index.html">
                <img src="images/MANO.png" alt="MANO project logo" width="50">
                </a>
            </div>

            <!-- Links centered in one line -->
            <div class="mb-3">
                <a class="footer-link mx-2" href="index.html">Home</a>
                <a class="footer-link mx-2" href="resources.html">Resources</a>
                <a class="footer-link mx-2" href="editor.html">Metadata Editor</a>
                <a class="footer-link mx-2" href="collection.html">Metadata Collection</a>
                <a class="footer-link mx-2" href="viewer.html">Transcription Viewer</a>
                <a class="footer-link mx-2" href="about.html">About</a>
            </div>

            <!-- Copyright centered -->
            <div class="text-center mt-2">
                <span>© 2025 <span class="mano">&lt;MANO&gt;</span></span>
            </div>

            </div>
        </footer>
        <div class="py-1 text-center">
            <small>
            <span class="m-1">
                Idea and Development: <a href="https://github.com/michelaparma" target="_blank" style="color: black!important">Michela Parma</a>
            </span> |
            <span class="m-1">
                <a href="https://github.com/orgs/mano-project/repositories" target="_blank" style="color: black!important"><i class="fa-brands fa-github"></i> GitHub Repositories</a>
            </span> |
            <span class="m-1">
                <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" style="color: black!important">CC BY-NC-SA 4.0</a><img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="Creative Commons" style="max-width: 1em;max-height:1em;margin-left: .2em;"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="Attribution" style="max-width: 1em;max-height:1em;margin-left: .2em;"><img src="https://mirrors.creativecommons.org/presskit/icons/nc.svg" alt="Non Commercial" style="max-width: 1em;max-height:1em;margin-left: .2em;"><img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" alt="Share Alike" style="max-width: 1em;max-height:1em;margin-left: .2em;">
            </span>
            </small>
        </div>

        <script>
            const repoOwner = "mano-project";
            const repoName = "mano-metadata";
            const folderPath = "data";

            let manuscripts = [];

            // Fetch file list from GitHub
            async function fetchFileList() {
            const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}`;
            const res = await fetch(apiUrl);
            const files = await res.json();
            return files.filter(f => f.name.endsWith(".json"));
            }

            async function fetchJSONFile(url) {
            const res = await fetch(url);
            return res.json();
            }

            // Initialize maps
            const europeCenter = [44.855656, 9.4841947,5]; //central Europe
            const zoomLevel = 4; // zoomed to Europe

            const mapCurrent = L.map('mapCurrent').setView(europeCenter, zoomLevel);
            const mapOrigin = L.map('mapOrigin').setView(europeCenter, zoomLevel);


            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
            }).addTo(mapCurrent);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
            }).addTo(mapOrigin);

            const currentMarkers = L.layerGroup().addTo(mapCurrent);
            const originMarkers = L.layerGroup().addTo(mapOrigin);

            // Group manuscripts by coordinates
            function groupByCoords(entries, fieldGeo, fieldLabel, fieldCountry) {
            const groups = {};
            entries.forEach(entry => {
                const geo = entry[fieldGeo];
                if (!geo) return;
                if (!groups[geo]) {
                groups[geo] = {
                    label: entry[fieldLabel]?.value || entry[fieldLabel] || "Unknown",
                    country: entry[fieldCountry]?.value || entry[fieldCountry] || "",
                    manuscripts: []
                };
                }
                //groups[geo].manuscripts.push(entry.msName  || "Untitled manuscript");
                groups[geo].manuscripts.push({
                title: entry.msName  || "Untitled manuscript",
                id: entry.idno || entry.msName 
                });
            });
            return groups;
            }

            // Plot grouped markers
            function plotMarkers() {
            currentMarkers.clearLayers();
            originMarkers.clearLayers();

            // Current Repositories
            const repoGroups = groupByCoords(manuscripts, "geoRepository", "repository", "countryIdent");
            for (const geo in repoGroups) {
                const [lat, lon] = geo.split(",").map(Number);
                const g = repoGroups[geo];
                const popupHtml = `
                    <b>${g.label}</b><br>${g.country}<br>
                    <ul>
                        ${g.manuscripts.map(m => 
                        `<li><a href="collection.html#ms-${m.id.replace(/\s+/g,"_")}" target="_blank">${m.title}</a></li>`
                        ).join("")}
                    </ul>
                    `;

                L.marker([lat, lon]).addTo(currentMarkers).bindPopup(popupHtml);
            }

            // Places of Origin
            const originGroups = groupByCoords(manuscripts, "geoOrigin", "origPlace", "countryOrigin");
            for (const geo in originGroups) {
                const [lat, lon] = geo.split(",").map(Number);
                const g = originGroups[geo];
                const popupHtml = `
                <b>${g.label}</b><br>${g.country}<br>
                <ul>
                    ${g.manuscripts.map(m => 
                    `<li><a href="collection.html#ms-${m.id.replace(/\s+/g,"_")}" target="_blank">${m.title}</a></li>`
                    ).join("")}
                </ul>
                `;
                L.marker([lat, lon]).addTo(originMarkers).bindPopup(popupHtml);
            }

            // Fit maps
            if (currentMarkers.getLayers().length > 0) {
                mapCurrent.fitBounds(currentMarkers.getBounds());
            }
            if (originMarkers.getLayers().length > 0) {
                mapOrigin.fitBounds(originMarkers.getBounds());
            }
            }

            // Load all data
            async function loadData() {
            const fileList = await fetchFileList();
            for (const f of fileList) {
                try {
                const rec = await fetchJSONFile(f.download_url);
                const entries = Array.isArray(rec) ? rec : [rec];
                manuscripts.push(...entries);
                } catch (err) {
                console.error("Error loading", f.name, err);
                }
            }
            plotMarkers();
            }

            loadData();
            </script>

    </body>
</html>
    
        

